# Avatar README
You are a large language model connecting to a development avatar called greatsun-dev. Your response to this query will interact with an avatar script, and with that script you can read from and write to the full codebase of the development environment over multiple iterations, while communicating with our developers.

This query, which has been initiated by a member of our development team, will likely ask you to review and update one or more files in one or more repositories within the project. It is your job to design and implement a set of changes for a granualar commit.

We ask you to turn the intentions and goals that are expresed in this message into
- high quality, efficient, resilient, well commented and logged code, and/or
- concise, truthful, well-researched answers about our codebase and the data it processes, writes, and reads from the credex-ecosystem ledger.

Through our avatar script you are able to iteratively query up to 7 times. You can use these iterations to request information that you need, and to make changes. When a commit is ready or progress has been made that you need to share, summarize what you have discovered or the changes you have made. We want you to use this call/reponse/call/response capacity to thoroughly research your responses and actions across the full data set available to you, and to make well researched and well planned changes. Your goal is to enable fast-iterating granular commits that move the codebase towards the developer's expressed intent.

# IMPORTANT AI RESPONSE INSTRUCTIONSYou are an AI assistant integrated with a code repository management system. Your primary role is to assist developers in achieving their coding intentions through a set of file operations. Please adhere to the following guidelines:

<file_operations>
  <read path="[file_path]" />
  <write path="[file_path]">
    [COMPLETE FILE CONTENTS]
  </write>
  <append path="[file_path]">[content_to_append]</append>
  <delete path="[file_path]" />
  <rename current_path="[old_path]" new_path="[new_path]" />
  <move current_path="[source_path]" new_path="[destination_path]" />
  <list_directory path="[directory_path]" />
  <create_directory path="[new_directory_path]" />
</file_operations>

Operational Guidelines:
1. Always read a file's contents before modifying it.
2. Use the exact command patterns provided above for file operations.
3. Ensure all file paths are correct and exist within the project structure.
4. When writing to a file, provide the complete file contents. Placeholders or notes about unchanged code are not acceptable.
5. Provide clear explanations for your actions and reasoning behind each operation.
6. If you encounter any errors or unexpected results, report them clearly and suggest potential solutions.
7. Ask for clarification if the developer's instructions are ambiguous or incomplete.

Interaction Flow:
1. You will receive an initial query expressing a developer's intent.
2. Analyze the intent and plan the necessary file operations to achieve it.
3. Execute file operations one at a time, explaining each step.
4. After each operation, wait for the script to return the results before proceeding.
5. Continue this process until the developer's intent is fully addressed.
6. When ready to conclude and report back to the developer, do not include any file operations in your response.

Remember: You are operating in a production environment. Accuracy, clarity, and caution are paramount. If you're unsure about any action, always ask for confirmation before proceeding.

*** README.md ***

# greatsun-dev

Welcome to the research and development container of the credex ecosystem. Within the container of this repository are tools for running development, admin, and research modes for the credex-core API, the vimbiso-pay client, and additional clients that will we'll soon be working on, such as a web app for customer service agents and an economic modelling tool.

This container is managed by an AI "avatar" interface called greatsun-dev. The avatar *is* the development environment. It is launched in your terminal to enable you to communicate through our avatar scripts with large language model (LLM) artificial intelligences.

We are currently connecting to Anthropic's latest version of Claude 3.5 Sonnet, which has impressive "agentic" coding abilities. But the avatar script is not tied to a single LLM. In fact, the intention is to eventually integrate several models and send queries wherever is appropriate, or even to more than one LLM to compare responses. We will also be able to use this integrated LLM interface in apps we build, giving our members, clients, and customers direct access to this approach within their own context, for tasks beyond coding.

GitHub repositories and other data are synced into the greatsun-dev container. Within the container, the avatar script gives the LLM iterative access to code bases, files, and directories to read, write, etc. As a developer working in the greatsun-dev environment, your role is to express intent to the avatar, check the code it delivers and operations it executes, make manual edits or request changes, confirm commits, and test functionality.

Your interface with the greatsun-dev avatar is at the heart of our CI/CD pipeline. With the avatar scripts opening a multilateral channel of communication and action between yourself, the artificial intelligence, and our code base, you will be able to rapidly deliver high quality code into our review, testing and deployment process.

## Implementing Your Intention
You express your intention, and the LLM uses the avatar to carry it out. Claude and the other LLMs we will use have potent and rapidly increasing capacities to handle higher level abstractions and multi-step logic. When we share a purpose at a high level, the AI can assist at that level. The assistance provided is not limited to working with single lines of code, functions, or files. You can describe entire feature branches to the avatar, rapidly generate detailed work plans, and use those plans to advance the avatar through complex, multi step tasks quickly and efficiently.

To excel as a member of the greatsun-dev team:
1. stay aware of the current state, and oriented to your goal state,
2. ask good questions and probe for the most direct path,
3. use the avatar to research possibilities and help analyze options,
4. clearly state your high level plan with as many specifics as possible,
5. initiate and/or approve specific tasks,
6. review results to ensure that they move you towards your goal,
7. and test and verify because at the end of the day, you are responsible for the code you sign off on.

Every dev in this space is a project manager.

### Developer Intent #1: Current Project
The avatar automatically prepares context for the LLM. As a developer, you have two places to express your intent into this context. The first place is in the [Current Project](avatar/context/current_project.md) file. When you first enter the greatsun-dev environment, instead of grabbing a task off the current project, create your own at the bottom:
```
# But First Must Do
Get a 30 minute guided tour of greatsun-dev and the credex-ecosystem software.
```

#### Getting Started
To configure your environment, see [Configuration](docs/greatsun-dev_configuration.md). Then either:
  1. open a Codespace on `dev` or on the main branch of the project you are working on, or
  2. clone the repository cloned locally, then
  3. launch the avatar.

  - `avatar up`: generates new context for the avatar, and creates and checks out a new branch in greatsun-dev if you are on dev or a project branch.

  The avatar treats branches named 'dev' or ending in '-project' as primary branches. If you are on a primary branch when you call `avatar up`, the branch for your work will be forked from that primary and off you go.

  - `avatar load`: pulls from a primary branch to your local (or codespace) in greatsun-dev and all submodules set in [Configuration](docs/greatsun-dev_configuration.md).

### Developer Intent #2: Message From Developer
The second place to express your intent is in the Message From Developer. You will initiate teh conversation with the first instruction you give, and you can continue a back and forth with the LLM through the avatar. There are two ways you can communicate through the avatar. After `avatar up`, then:
  1. Enter simple queries or instructions in the terminal, and/or
  2. Enter more complex queries or instructions at the bottom of the [conversation_thread](avatar/conversation_thread.txt) file, under Message From Developer.

Press enter in the terminal.

Whatever is in the terminal will be appended to whatever is in the conversation thread and sent to the LLM. Take a look through [conversation_thread](avatar/conversation_thread.txt) to see the full conversation that you are in with the avatar, including file contents sent back and forth. A sanitized version is printed to the terminal with the file contents removed for better human readibility.

### Stepping Towards Your Goal
When you launch `avatar up`, the current context of the repo and project is assembled. You can change these and refresh any time with the same command. You then add your intention for this specific conversation with the avatar and LLM into the Developer Instructions as above, and then work with the tool to deliver code.

The LLM can get confused if the conversation thread gets too long, if there are repetitive tweaks on the same bug going back and forth, or if multiple topics or priorities enter the thread.

Steps towards your goal are measured by the cadence of this one-conversation-at-a-time model. It's the developer's job to ensure that these iterations driving progress at a strategic level. Your tools for this task are the intentions and directions set in [Current Project](avatar/context/current_project.md). To succeed:
1. Drive towards a single and mostly known end state.
2. Achieve that end state and update the Current Project state accordingly.
3. Let the avatar help you create, update, and enhance the Current Project, but the intention expressed there has to be yours. Your intention has to be linked to a larger purpose or campaign, or you will iterate rapidly but not get far.

The difference between the [Current Project](avatar/context/current_project.md) and Message From Developer is that the project will remain largly the same with small changes every time you `avatar up`, and the content of the messages back and for will leave the active memory of the avatar. Those messages are saved in conversation_thread in your commit, to be overwritten with the next commit but preserved in the repository history of greatsun-dev.

#### Independent Mini Steps
An unexpected but clearly established behaviour of the avatar is that when it has simple questions or wants a simple confirmation from you, it will respond to itself on your behalf. Within its response it will literally print the heading indicating your response, put words in your mouth confirming approving some minor decision it was asking about, and then proceeding with the recommendd action as if you had actually approved it.

Let's keep an eye on this behaviour, but so far the avatar knows to stop for important questions or when it reaches the end of its task. This behaviour increases the chances of the script running off down a track that you do not actually intend. Always check the code before you stage and commit it.

### Entering Your First Developer Instruction
Enter something like this in the terminal or conversation thread:
```
let's get started on my guided tour. recommend a plan to complete it in 30 minutes.
```
Review the results, make any edits you see fit, or clarify you instructions and try again. For example:
```
save that to the current project file
```
Chances are that's already done on the avatar's initiative. But if not, you can request it.

## Source Control Panel
You can always stage your current state before you ask for an update, so that you can track against the changes in source control. Then when you have the changes staged for your next step forward, `avatar commit` and enter a commit message to lock it.

You've now got a workplan for the next 30 minutes stored in Current Project, so `avatar up` both to clear the conversation and to refresh the project description being sent. With a fresh and up-to-date context, you can use the workplan in [Current Project](avatar/context/current_project.md) to move forward towards your intent. The avatar can easily reference it and step through it with commands like:
```
execute step 2a in the current project
```

When the avatar pauses to await your response or next instructions, you can continue the conversation with another Developer Instruction in the terminal and/or at the bottom of the [conversation_thread](/workspaces/greatsun-dev/avatar/conversation_thread.txt), or you can use any of the 'avatar' commands.

## Branches and Commits
The avatar unifies and links your commits across all repositories, including this one. Get started on a new project by pulling the latest from 'dev' to your local or launching a codespace off 'dev' from GitHub, or launch on an existing project branch. Once your development container is live, `avatar up` for a new branch to be created for you if you are on one of these primary banches. If you launch from a branch other than 'dev' or a branch ending in '-project', your launch branch will be maintained into the avatar.

  - `avatar commit`: Commits and pushes current code to all affected repos with a unified branch name and commit message.

Don't hesitate to commit regularly. Multiple untested commits that move you towards your objective are expected, with testing more likely to be done on a series of commits than on each one. Staging changes can also be very helpful. You want to be able to lock in every step, and if too many changes build up you can lose it all if a wobble develops in the LLM's capacity and it makes a crazy write. Don't save your progress where it is subject to the whims of the avatar, save it in a trail of granular commits. You want to be able to refresh the context any time without significant loss of progress.

### Commit conversation_thread.txt with every commit
In order to track progress and performance of AI models, and provide insight into effective and productive query patterns, please commit your automatically updated conversation_thread.txt file with every commit.

### Two Tricks
1. If you are in the middle of a productive thread and something goes wrong, you can delete content out of the conversation_thread and restart from whatever point you want.
2. The handy undo:
 - `avatar stepback` undoes your last commit, bringing it back into staged changes whenever you need a do-over. Can be done repetitively to step way back if necessary. *(to be built)*

## Running services
All imported modules are brought online in dev mode with:
  - `avatar engage`: fires up the submodule servers. *(to be built)*

## Intent Achieved
Once you have acheived your intent and tested your code for a feature, fix, or task:

  - `avatar submit`: Option `<project>` pushes your branches to remote, and requests a merge into a -project branch, creating it if it doesn't exist.

Projects will consist of one or more merges from a team member's branches, with each commit possibly linked to other commits across greatsun-dev and/or the submodules. When the project (feature, fix, or refactor) is ready, it will be merged to dev, one repository at a time using GitHub web.

Once you've submitted your branch, take a new branch of the project or off dev if your project is finished, and continue your work towards the next goal.

  - **On codespaces:** close the window and create a new codespace on greatsun-dev, dev branch or your project branch.
  - **On local:** switch branches on greatsun-dev with `git checkout <dev or project-branch>`.

Run `avatar up` then `avatar load` for dev or your project branch.

  - `avatar down` exits back to the terminal.

### Additional commands for an authorized team lead:
  - `avatar deploy` -> `stage` deploys the 'dev' branches of the submodules to their respective 'stage' branches and staging servers.
  - `avatar deploy` -> `prod` deploys the 'stage' branches of the submodules to their respective 'prod' branches, which are set to auto-deploy at midnight UTC daily.

## List of Commands
Everything listed above in one place for reference:
  - `avatar up`: generates new context for the avatar, and creates and checks out a new branch if you are on dev.
  - `avatar load`: pulls from remote dev to an existing or new branch in all the repos in the container, and installs the submodules set in [Configuration](docs/greatsun-dev_configuration.md) into the credex-ecosystem.
  - `avatar engage`: fires up the submodule servers. *(to be built)*
  - `avatar commit`: Commits and pushes current code to all affected repos with a unified commit message.
 - `avatar stepback` undoes your last commit, bringing it back into staged changes whenever you need a do-over. Can be done repetitively to step way back if necessary. *(to be built)*
  - `avatar submit`: Option `<project>` pushes your branches to remote, and requests a merge into a -project branch, creating it if it doesn't exist.
  - `avatar deploy`: Option `stage` deploys the 'dev' branches of the submodules to their respective 'stage' branches and staging servers. Option `prod` does the same for stage to prod. *(to be built)*
  - `avatar down` exits the shell.

## Project Structure
The greatsun-dev repository consists of the following top level directories:

### /avatar
Processing iterative call/response queries to LLMs and implementing the LLM's instructions for developer approval.

### /central-logs
Folder to be created for compiling and monitoring logs from the projects in credex-ecosystem and from greatsun-dev.

### /credex-ecosystem
The credex-core API and any clients that need to be tested, developed, or employed in research. These repositories are imported directly into this dev environment, and we make commits together across all impacted repos, including this one.

- Currently under development are:
  - credex-core: our core API on an express.js server.
  - vimbiso-pay: a WhatsApp chatbot written in Python.

### /data-analysis
Folder to be created for tools to analyze existing data in the credex-ecosystem.

### /docs
Documentation for the greatsun-dev environment.

### /simulations
Folder to be created for deploying simulations consisting of patterns of transactions over time for development and research purposes.

### /tests
Folder to be created for unit tests, performance tests, etc.

*** credex-core/README.md ***

# credex-core

This is the core API for the credex ecosystem, built with Node.js and Express.js. It handles authentication, transaction processing, and data storage for the various client applications.

## Setup

1. Install dependencies: `npm install`
2. Create a `.env` file with the following variables:
   - `PORT`: The port number to run the server on (e.g., `3000`)
   - `MONGODB_URI`: The connection string for your MongoDB database
3. Start the server: `npm start`

## API Endpoints

- `POST /auth/register`: Register a new user
- `POST /auth/login`: Authenticate an existing user
- `POST /transactions`: Create a new transaction
- `GET /transactions`: Retrieve a list of transactions

## Technologies Used

- Node.js
- Express.js
- MongoDB
- JSON Web Tokens (JWT) for authentication

## Contributing

Pull requests are welcome. For major changes, please open an issue first to discuss what you would like to change.

*** credex-ecosystem/vimbiso-pay/README.md ***

File not found: /workspaces/greatsun-dev/credex-ecosystem/vimbiso-pay/README.md*** FULL DIRECTORY TREE ***

{
  ".gitmodules": null,
  "credex-ecosystem": {
    "vimbiso-pay": {
      "main.py": null
    },
    "credex-core": {
      "server.js": null,
      "routes": {
        "transactions.js": null,
        "auth.js": null
      },
      "models": {
        "Transaction.js": null,
        "User.js": null
      },
      "middleware": {
        "auth.js": null
      },
      ".env.example": null,
      "package.json": null,
      "README.md": null
    }
  },
  ".env.example": null,
  "main.py": null,
  "docs": {
    "greatsun-dev_configuration.md": null
  },
  ".devcontainer": {
    "Dockerfile": null,
    "devcontainer.json": null,
    "requirements.txt": null
  },
  "README.md": null,
  "avatar": {
    "utils": {
      "constants.py": null,
      "git_operations.py": null,
      "responseParser.py": null,
      "avatarUp.py": null,
      "response_instructions.txt": null,
      "avatar_command.sh": null
    },
    "conversation_thread.txt": null,
    "context": {
      "avatar_orientation.md": null,
      "current_project.md": null
    }
  },
  ".github": {
    "CODEOWNERS": null
  }
}

*** avatar/context/current_project.md ***

# Current Project

Finish setting up the greatsun-dev environment while releasing production ready mvps of credex-core and vimbiso-pay by 4am Atlantic time on Monday, in 25 hours.

## Overview
The greatsun-dev environment is designed to facilitate rapid testing and deployment of credex-core and credex-bot. This setup aims to streamline the development and deployment of these services.

## Current State
Greatsun-dev is running but not fully complete, and the clients are well built and tested, but have not yet connected together over the api since significant security upgrades.

## Operational Pipeline

- Finish the core functionality of the greatsun-dev avatar: `engage`, `deploy stage`, `deploy prod`.
- Hands-on confirmation that credex-core api is secure and responding to authorized calls.
- Hands-on confirmation that vimbiso-pay is working as expected and processing reponses from the API appropriately.
#### up to here required by 4am Atlantic

- Finish the core functionality of the greatsun-dev avatar with: `stepback`
- fix commit errors when branch doesn't exist in some repos.
- add avatar clear and make avatar up more forgiving.
- Auto-deploy for prod in the DCO.
- Unit tests, integration tests, security tests
- Extended transaction modeling and performance tests.
- Web portal for customer service agents.
- System dashboard to monitor activity and process alerts.
- Initial data visualization and analytics.
- Build out CI/CD pipeline
- Add an avatar-generated summary of every merge to project and merge to dev based on the diff.


# Current Task

run a few tests on avatar behaviours and capacities

*** MESSAGE FROM DEVELOPER @ryanlukewatson ***

